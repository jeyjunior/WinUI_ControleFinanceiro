-- =============================================
-- SCRIPT DE INSERTS PARA DADOS DE TESTE
-- =============================================

-- Inserir Usu�rio de teste
INSERT INTO Usuario (Email, Nome, LoginApi, DataCadastro, Ativo)
VALUES ('usuario.teste@gmail.com', 'Usuário Teste', 'google_oauth_data', GETDATE(), 1);

-- Inserir Tipos de Opera��o
INSERT INTO TipoOperacaoFinanceira (Nome) VALUES 
('Entrada'),
('Saída');

-- Inserir Status de Pagamento
INSERT INTO StatusPagamento (Nome) VALUES 
('Pago'),
('Em Aberto'),
('Vencido');

-- Inserir Categorias
INSERT INTO Categoria (Nome, FK_Usuario) VALUES 
('Salário', NULL),
('Freelance', NULL),
('Aluguel', NULL),
('Condominio', NULL),
('Alimentação', NULL),
('Transporte', NULL),
('Lazer', NULL),
('Saúde', NULL),
('Educação', NULL),
('Investimentos',NULL);

-- Inserir Entidades Financeiras
INSERT INTO EntidadeFinanceira (Nome, FK_Usuario) VALUES 
('Empresa XYZ', NULL),
('Imobiliária ABC', NULL),
('Condomínio Edifício Central',NULL),
('Supermercado Preço Bom', NULL),
('Posto de Gasolina Shell', NULL),
('Uber/Táxi',NULL),
('Restaurante Sabor Caseiro', NULL),
('Academia Fit', NULL),
('Hospital Saúde Total',NULL),
('Faculdade USP', NULL),
('Senhor Zé - Serviços Gerais', NULL);

INSERT INTO OperacaoFinanceira (
    FK_TipoOperacao, FK_EntidadeFinanceira, FK_Categoria, FK_StatusPagamento, 
    Valor, DataOperacao, DataVencimento, Descricao, FK_Usuario
) VALUES 
-- ENTRADAS
(1, 1, 1, 2, 2500.00, '2024-01-05', '2024-01-05', 'Salário mensal', null), -- Pago
(1, 1, 2, 1, 500.00, NULL, '2024-01-20', 'Freelance desenvolvimento', null), -- Em Aberto

-- SA�DAS - PAGAS
(2, 2, 3, 2, 1000.00, '2024-01-10', '2024-01-10', 'Aluguel janeiro', null),
(2, 3, 4, 2, 350.00, '2024-01-08', '2024-01-08', 'Condomínio janeiro', null),
(2, 4, 5, 2, 450.00, '2024-01-12', '2024-01-12', 'Compras do mês', null),
(2, 5, 6, 2, 200.00, '2024-01-15', '2024-01-15', 'Abastecimento carro',null),
(2, 6, 6, 2, 80.00, '2024-01-18', '2024-01-18', 'Corridas de Uber', null),

-- SA�DAS - EM ABERTO (contas futuras)
(2, 2, 3, 1, 1000.00, NULL, '2024-02-10', 'Aluguel fevereiro', null),
(2, 3, 4, 1, 350.00, NULL, '2024-02-08', 'Condomínio fevereiro', null),
(2, 8, 8, 1, 120.00, NULL, '2024-02-05', 'Mensalidade academia', null),
(2, 11, 7, 1, 300.00, NULL, '2024-02-15', 'Serviço de pintura', null),

-- SA�DAS - VENCIDAS (exemplo de atraso)
(2, 9, 8, 3, 150.00, NULL, '2023-12-20', 'Consulta médica', null);

-- =============================================
-- CONSULTAS DE VERIFICA��O
-- =============================================

-- Verificar totais por tipo
SELECT 
    tof.Nome as Tipo,
    COUNT(*) as Quantidade,
    SUM(o.Valor) as Total
FROM OperacaoFinanceira o
INNER JOIN TipoOperacaoFinanceira tof ON o.FK_TipoOperacaoFinanceira = tof.PK_TipoOperacaoFinanceira
GROUP BY tof.Nome;

-- Verificar opera��es por status
SELECT 
    sp.Nome as Status,
    COUNT(*) as Quantidade,
    SUM(o.Valor) as Total
FROM OperacaoFinanceira o
INNER JOIN StatusPagamento sp ON o.FK_StatusPagamento = sp.PK_StatusPagamento
GROUP BY sp.Nome;

-- Listar opera��es em aberto (pr�ximas do vencimento)
SELECT 
    o.PK_OperacaoFinanceira,
    tof.Nome as Tipo,
    ef.Nome as Entidade,
    c.Nome as Categoria,
    o.Valor,
    o.DataVencimento,
    o.Descricao
FROM OperacaoFinanceira o
INNER JOIN TipoOperacaoFinanceira tof ON o.FK_TipoOperacaoFinanceira = tof.PK_TipoOperacaoFinanceira
INNER JOIN EntidadeFinanceira ef ON o.FK_EntidadeFinanceira = ef.PK_EntidadeFinanceira
INNER JOIN Categoria c ON o.FK_Categoria = c.PK_Categoria
INNER JOIN StatusPagamento sp ON o.FK_StatusPagamento = sp.PK_StatusPagamento
WHERE sp.Nome = 'Em Aberto'
AND o.DataVencimento >= GETDATE()
ORDER BY o.DataVencimento;